<div class="product-form__container">
  <div class="product-form__form-container">
    <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="form">
      <h1>Formulario de Registro</h1>

      <div class="product-form__row">
        <div class="form-group">
          <label class="form-label" for="id">ID</label>
          <input
            class="form-control"
            type="text"
            id="id"
            formControlName="id"
            [class.is-invalid]="(productForm.get('id')?.invalid && productForm.get('id')?.touched) || productForm.get('id')?.errors?.['idExists']"
          />
          <div
            class="product-form__error"
            *ngIf="(productForm.get('id')?.invalid && productForm.get('id')?.touched) || productForm.get('id')?.errors?.['idExists']"
          >
            <span *ngIf="productForm.get('id')?.errors?.['required']"
              >ID es requerido!</span
            >
            <span *ngIf="productForm.get('id')?.errors?.['minlength']"
              >ID debe tener al menos 3 caracteres</span
            >
            <span *ngIf="productForm.get('id')?.errors?.['maxlength']"
              >ID no puede tener más de 10 caracteres</span
            >
            <span *ngIf="productForm.get('id')?.errors?.['idExists']"
              >Este ID ya está en uso</span
            >
            <span *ngIf="productForm.get('id')?.pending"
              >Verificando disponibilidad...</span
            >
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="name">Nombre</label>
          <input
            class="form-control"
            type="text"
            id="name"
            formControlName="name"
            [class.is-invalid]="
              productForm.get('name')?.invalid &&
              productForm.get('name')?.touched
            "
          />
          <div
            class="product-form__error"
            *ngIf="
              productForm.get('name')?.invalid &&
              productForm.get('name')?.touched
            "
          >
            <span *ngIf="productForm.get('name')?.errors?.['required']"
              >Nombre es requerido!</span
            >
            <span *ngIf="productForm.get('name')?.errors?.['minlength']"
              >Nombre debe tener al menos 5 caracteres</span
            >
            <span *ngIf="productForm.get('name')?.errors?.['maxlength']"
              >Nombre no puede tener más de 100 caracteres</span
            >
          </div>
        </div>
      </div>

      <div class="product-form__row">
        <div class="form-group">
          <label class="form-label" for="description">Descripción</label>
          <input
            class="form-control"
            type="text"
            id="description"
            formControlName="description"
            [class.is-invalid]="
              productForm.get('description')?.invalid &&
              productForm.get('description')?.touched
            "
          />
          <div
            class="product-form__error"
            *ngIf="
              productForm.get('description')?.invalid &&
              productForm.get('description')?.touched
            "
          >
            <span *ngIf="productForm.get('description')?.errors?.['required']"
              >Este campo es requerido!</span
            >
            <span *ngIf="productForm.get('description')?.errors?.['minlength']"
              >Descripción debe tener al menos 10 caracteres</span
            >
            <span *ngIf="productForm.get('description')?.errors?.['maxlength']"
              >Descripción no puede tener más de 200 caracteres</span
            >
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="logo">Logo</label>
          <input
            class="form-control"
            type="text"
            id="logo"
            formControlName="logo"
            [class.is-invalid]="
              productForm.get('logo')?.invalid &&
              productForm.get('logo')?.touched
            "
          />
          <div
            class="product-form__error"
            *ngIf="
              productForm.get('logo')?.invalid &&
              productForm.get('logo')?.touched
            "
          >
            <span *ngIf="productForm.get('logo')?.errors?.['required']"
              >Este campo es requerido!</span
            >
          </div>
        </div>
      </div>

      <div class="product-form__row">
        <div class="form-group">
          <label class="form-label" for="date_release">Fecha Liberación</label>
          <input
            class="form-control"
            type="date"
            id="date_release"
            formControlName="date_release"
            [min]="today"
            [class.is-invalid]="
              productForm.get('date_release')?.invalid &&
              productForm.get('date_release')?.touched
            "
          />
          <div
            class="product-form__error"
            *ngIf="
              productForm.get('date_release')?.invalid &&
              productForm.get('date_release')?.touched
            "
          >
            <span *ngIf="productForm.get('date_release')?.errors?.['required']"
              >Este campo es requerido!</span
            >
            <span *ngIf="productForm.get('date_release')?.errors?.['minDate']"
              >La fecha debe ser igual o posterior a hoy</span
            >
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="date_revision">Fecha Revisión</label>
          <input
            class="form-control"
            type="date"
            id="date_revision"
            formControlName="date_revision"
            readonly
          />
        </div>
      </div>

      <div class="product-form__global-error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="product-form__actions">
        <button type="button" class="btn-secondary" (click)="onReset()">
          Reiniciar
        </button>
        <button type="submit" class="btn-primary" [disabled]="!isFormValid()">
          {{ isLoading ? "Enviando..." : "Enviar" }}
        </button>
      </div>
    </form>
  </div>
</div>
